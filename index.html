
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Steven Brooks' Blog</title>
  <meta name="author" content="Steven Brooks">

  
  <meta name="description" content="Hadn&rsquo;t been able to blog as much as I wanted in the last few days so I thought I&rsquo;d write about something cool. Lately, an app I have been &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://stevenabrooks.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Steven Brooks' Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Steven Brooks' Blog</a></h1>
  
    <h2>Student @Flatiron School</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:stevenabrooks.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/29/count/">What&#8217;s This Difference</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-29T10:23:00-05:00" pubdate data-updated="true">Jan 29<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hadn&rsquo;t been able to blog as much as I wanted in the last few days so I thought I&rsquo;d write about something cool.  Lately, an app I have been working on has the potential to be seen by a very high volume of users, so in creating this application performance has to be something I am considering.</p>

<p>So then to that extent I ask you, &ldquo;What&rsquo;s the difference between</p>

<p>Model.all.count</p>

<p>and</p>

<p>Model.count?&#8221;</p>

<p>Let&rsquo;s assume that the model we are referring to is Event.  Right now, in one of my apps I have roughly 350 or so events in my database.  Not big but can still serve the purpose of this blog post.  Both lines of code return us the same count, 350 or so.  With that I&rsquo;m mind, what&rsquo;s the difference?</p>

<p>Well when we run <code>Event.all</code> what does that do?  That returns an array of events.  So then we would be running count on that array of events.  Effectively, our SQL query would be something like <code>SELECT "events".* FROM "events"</code>.  We would load the array and then run a count query on that array.</p>

<p>When we run <code>Event.count</code> are we running count on an array?  No we are not.  Effectively, our SQL query here is <code>SELECT COUNT(*) FROM "events"</code>.  Here, we are running a count query on the DB.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/14/heroku-schedule/">15 Second Heroku Wait?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-14T10:23:00-05:00" pubdate data-updated="true">Jan 14<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here is the scenario you are in. You built a Rails app.  Congrats.  You have also pushed you app to <a href="http://heroku.com/">Heroku</a>.  Even better.  But after every hour, your Heroku server is seemingly shut down; that&rsquo;s why it can be free because it&rsquo;s not always &ldquo;in use&rdquo;.</p>

<p>There&rsquo;s an easy way to combat that for free.</p>

<p>1) Make a rake task that will &ldquo;ping&rdquo; your site.</p>

<figure class='code'><figcaption><span> (update.rb)</span> <a href='/downloads/code/update.rb'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="n">desc</span> <span class="s2">&quot;Pings PING_URL to keep a dyno alive&quot;</span>
</span><span class='line'><span class="n">task</span> <span class="ss">:dyno_ping</span> <span class="k">do</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s2">&quot;net/http&quot;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">(</span><span class="s2">&quot;YOUR SITE&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">response</span> <span class="o">=</span> <span class="ss">Net</span><span class="p">:</span><span class="ss">:HTTP</span><span class="o">.</span><span class="n">get_response</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>2) Install <a href="https://scheduler.heroku.com">Heroku Scheduler</a> and set have it run the rake task every hour.</p>

<p>That&rsquo;s it.  Now every time you go to your site you won&rsquo;t have to wait 15 second for it to load.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/13/stubhub/">Open Source</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-13T09:25:00-05:00" pubdate data-updated="true">Jan 13<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a teaser post.  For the last few days I have been using a pretty popular ruby gem that was not working correctly.  With the help of a few people, I was able to find the error, make the correction, and write a passing test for the new code.  I have sent a pull request and hopefully it is accepted.  If it is I will write about it.  Could be my first open source commit.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/01/07/angular/">Angular on Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-01-07T09:25:00-05:00" pubdate data-updated="true">Jan 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post will show a step by step tutorial of how to create a rails app with Angular.js on the front-end and allow you to successfully create an object and view those objects.</p>

<p>First, lets create the rails app</p>

<p><code>rails new angular</code></p>

<p>After you <code>cd</code> into the app, we are going to create a resource for the model we are going to have.  A resource will provide you with the model, an empty controller, a views folder with no views, and resourced routes for that model.  Close to scaffolding but not really.  Lets make a user model and give it a name:</p>

<p><code>rails g resource user name</code></p>

<p>and don&rsquo;t forget to migrate the database.</p>

<p><code>rake db:migrate</code></p>

<p>Next we have to create a controller with just an index action because the entire app will take place in that single action.  Lets call the controller home.</p>

<p><code>rails g controller home index</code></p>

<p>Next we have to remove the public/index.html file and make sure to add the home#index route as your root route:</p>

<p><code>root :to => &ldquo;home#index&rdquo;</code></p>

<p>Remember that empty user controller?  We have to go back to it now and create the RESTful data source for our app to interact with.  It&rsquo;s really not too too crazy.  For the purposed of this app we are only going to have an index action and a create action:</p>

<figure class='code'><figcaption><span> (AngularController.rb)</span> <a href='/downloads/code/AngularController.rb'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='rb'><span class='line'><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">respond_to</span> <span class="ss">:json</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="n">respond_with</span> <span class="no">User</span><span class="o">.</span><span class="n">all</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>    <span class="n">respond_with</span> <span class="no">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now we need to add Angular.js to the app.  In your Gemfile, and in the assets group, we need to add the Angular.js gem:</p>

<p><code>gem &lsquo;angularjs-rails&rsquo;</code></p>

<p>And in our application.js file, we need to add the following lines:</p>

<p><code>//= require angular</code><br>
<code>//= require angular-resource</code></p>

<p>Awesome, were doing pretty well thus far.  Next we have to tell our app &ldquo;Hey, you need to be in Angular.js&rdquo;, so go over to your application layout file and look for your html tag.  We need to add something to this tag to tell the app it&rsquo;s going to be in Angular.  For this we do the following:</p>

<p><code>html ng-app</code></p>

<p>This directive is used to flag the html element and tell it that Angular should be considered the root element of our application.  You can add a directive like this to other elements in your app if you wish to not have the entire app be Angular.</p>

<p>That is your basic setup.  We have Angular in our app and our html elements is ready.</p>

<p>Now we have a view.  I&rsquo;m going to show the view and then talk about whats going on here:</p>

<figure class='code'><figcaption><span> (angularview.html)</span> <a href='/downloads/code/angularview.html'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;div</span> <span class="na">ng-controller=</span><span class="s">&quot;UserController&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ul&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li</span> <span class="na">ng-repeat=</span><span class="s">&quot;user is users&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      {{ user.name }}
</span><span class='line'>    <span class="nt">&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>  <span class="nt">&lt;form&gt;</span>
</span><span class='line'>    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">ng-model=</span><span class="s">&quot;newUser.name&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;button</span> <span class="na">ng-click=</span><span class="s">&quot;addUser()&quot;</span><span class="nt">&gt;</span>Add User<span class="nt">&lt;/button&gt;&lt;br&gt;</span>
</span><span class='line'>    <span class="nt">&lt;span&gt;</span>{{newUser.name}}<span class="nt">&lt;/span&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/form&gt;</span>
</span><span class='line'><span class="nt">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>At the top of the view we have:</p>

<p><code>div ng-controller=&ldquo;UserController&rdquo;</code></p>

<p>Eventually, we will create an Angular controller, and what we are doing here is saying, &ldquo;Anything in this div refers to the UserController&rdquo;.  We are then creating a list, and each list item has the following code attached:</p>

<p><code>li ng-repeat=&ldquo;user in users&rdquo;</code></p>

<p>Eventually, we will have an array of users, and ng-repeat is a way to iterate through the array.  And then we simply list the users names.</p>

<p>Next we have a form with an input field.  This input field has:</p>

<p><code>ng-model=&ldquo;newUser.name&rdquo;</code></p>

<p>This ng-model is almost like a variable in that we will be setting this ng-model to whatever we put in the input field.</p>

<p>Then we have a button that has:</p>

<p><code>ng-click=&ldquo;addUser()&rdquo;</code></p>

<p>We are attaching ng-click to the button and that will run an addUser function that we will have to create.  In the span element, you will see a double binded value of the input field.  When you are typing in text to the input field, it will show here.  It&rsquo;s more of a cool thing to have than necessary.  Now all we need is that angular controller.</p>

<figure class='code'><figcaption><span> (angularmodule.js)</span> <a href='/downloads/code/angularmodule.js'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">&quot;User&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ngResource&quot;</span><span class="p">])</span>
</span><span class='line'>
</span><span class='line'><span class="kd">function</span> <span class="nx">UserController</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$resource</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">User</span> <span class="o">=</span> <span class="nx">$resource</span><span class="p">(</span><span class="s2">&quot;/users.json&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">users</span> <span class="o">=</span> <span class="nx">User</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$scope</span><span class="p">.</span><span class="nx">addUser</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">entry</span> <span class="o">=</span> <span class="nx">User</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">newUser</span><span class="p">.</span><span class="nx">name</span><span class="p">})</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">entry</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">$scope</span><span class="p">.</span><span class="nx">newUser</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>At the top, we create a module which we call &ldquo;User&rdquo;.  Going back to our layout file, we need to add this module to our directive.  That html element will now look like this:</p>

<p><code>html ng-app=&ldquo;User&rdquo;</code></p>

<p>To create a controller in Angular is like creating a javascript class, with a function.  We create it by adding in a scope.  A scope is an object that refers to the application model, kinda like self in ruby or this in javascript, but also not really.</p>

<p>In order to set our array, remember its called users in the view, we have to find a way to get that data of users from the database.  Remember when we added angular-resource to the application.js file, and remember when we added ngResource to our module?  We did this to set up Angular resource which allows you to interact with restful server side data source (our user controller in railsland).</p>

<p>In that first line we are saying, set the User variable to all the objects at the route &ldquo;/users.json&rdquo;.  The reason we cannot simply give the route of &ldquo;/users&rdquo; is because the return html and not json.  In the next line we set the scope.users to User.query().  The query function allows you to GET an array.</p>

<p>Awesome now all we want to do is add users to that array.  In the view, the button had an ng-click=&ldquo;addUser()&rdquo; on it.  We needed to create that function and we do it here.  Here we are getting the input from the form field with an ng-model of newUser.name and saving it to the object.  In angular, the .save method is used to create an object and not update it.  Then all we do is push that entry into the users array that we set above and set the input field to blank.</p>

<p>Now we can create an object and get an array of objects in a rails app that utilizes Angular.js on the client side.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/27/push-to-heroku/">Heroku, AWS, DNS Simple</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-27T09:25:00-05:00" pubdate data-updated="true">Dec 27<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&rsquo;s the scenario.  You have a site you created locally.  It has file uploading.  You have a domain name.  You don&rsquo;t want to take forever compiling assets and doing all that stuff to push the code to a server.</p>

<p>Okay, that&rsquo;s probably not a lay up that you have all those things.  But I had to find a way to get those images to same in production and find an easy way just to push the code to production.</p>

<p>To do this I used three things:</p>

<ol>
<li><a href="https://www.heroku.com/%E2%80%8E">Heroku</a></li>
<li><a href="http://aws.amazon.com/">AWS</a></li>
<li><a href="https://dnsimple.com/domains">DNS Simple</a></li>
</ol>


<p>Let&rsquo;s start from the top.  Heroku. Things to note here.  You have to use at least rails 3 and ruby 2.  I was not using ruby 2 so we have to go into our gemfile and add the line:</p>

<p>ruby &lsquo;2.0.0&rsquo;</p>

<p>and then run the bundler.  You might have an issue or two with other gems but the bundler usually tells you that you can do to fix it.</p>

<p>Now, Heroku also requires you use a Postgresql database in production, so we need to take our sqlite3 db and add it to the test and development groups on our gem file and add the &lsquo;pg&rsquo; gem to our production group.  Bundle it.  Okay Heroku is &ldquo;ready&rdquo;.</p>

<p>Now on to AWS.  This is where I will be storing my files that are uploaded to my application.  Since <a href="https://github.com/carrierwaveuploader/carrierwave">CarrierWave</a> is just hosting them locally, I will need a way for those files to work in production.  To set up AWS, you need to first go and create an account.  I&rsquo;m not going to tell you how to do that.  First, you need to add the &ldquo;fog&rdquo; gem to your gemfile and bundle.</p>

<p>Then make an initializer file.  Mine is called &ldquo;carrierwave.rb&rdquo; because I am using carrierwave for file processing.  Here is my initializer file:</p>

<p><img src="/images/aws.png" alt="My params" /></p>

<p>Pretty simple all we have to do if add our aws_access_key_id, aws_secret_access_key, and our fog_directory.  Super simple, and now when we upload files they will be saved in our backer on S3.</p>

<p>Let throw it up on heroku and see what&rsquo;s going on.  Follow this tutorial if you don&rsquo;t know how to set yourself up on <a href="https://devcenter.heroku.com/articles/getting-started-with-rails3">Heroku</a>.  It&rsquo;s a joke how easy it is.</p>

<p>But now we have a app on Heroku and the files are storage on AWS so they will work in production, but now we want to use our super cool domain that we bought from GoDaddy.  No problem.  Enter <a href="https://dnsimple.com/domains">DNS Simple</a>.</p>

<p>We head to <a href="https://dnsimple.com/domains">DNS Simple</a>, and set up an account.  After we log in, we add a domain.  Then we go to services, and scroll down to Heroku and click on that.  Then we go back and click on the Advanced Editor where we see our domain with an ALIAS and CNAME.  Change the content of the ALIAS to your url (with the www) and the content of the CNAME to your heroku app&rsquo;s url.  This tells your domain to redirect everything to your heroku url.  Now head on back to heroku and go into the settings of your app.  GO down to url&rsquo;s and add the the cool url.</p>

<p>You have now successfully pushed an app to production, made the files work in production, and set up that code on your fancy url.  Nice</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/18/rails-upload-download/">Upload/Download in Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-18T09:25:00-05:00" pubdate data-updated="true">Dec 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Okay I&rsquo;m back.  When we last left we had two request for the current app I&rsquo;m working on.  We nailed the first, now on to the second task.  We are supposed to allow the client to upload files so that people can download them from the app.  Again, no idea before I started.</p>

<p>Well here&rsquo;s something nice, I already am using <a href="https://github.com/carrierwaveuploader/carrierwave">CarrierWave</a> and feel pretty comfortable with it.  A thing to note is that most people assume this gem is only good for uploading images (likely due to the <a href="http://railscasts.com/episodes/253-carrierwave-file-uploads">Railscast episode</a>). It&rsquo;s not, actually its great for many files (I am currently upload .mp3, .mp4, .mov, and .wav files).</p>

<p>So I know how to upload the files, but how do you view the file or download it?</p>

<p>I stumbled upon how to view the file when I was trying to make it download:</p>

<p><img src="/images/linkview.png" alt="My params" /></p>

<p>We are simply linking to where the upload attachment is.  Now for download:</p>

<p><img src="/images/linkdownload.png" alt="My params" /></p>

<p>Here we are linking to the attachment url and downloading the file.  Not bad once you know how to do it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/18/acts_as_list/">Acts_as_List With Active Admin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-18T09:23:00-05:00" pubdate data-updated="true">Dec 18<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today has been a great day for me thus far.  For the current site I am working on, the client requested two features recently:</p>

<p>1) Allow him to reposition images(order)</p>

<p>2) Allow him to upload files and have his clients view/download them</p>

<p>Cool.  Had no idea how to do either off the top of my head.  Let&rsquo;s try to tackle the first one.</p>

<p>On a high level, I was thinking this process should go something like this:</p>

<ul>
<li>See if an object had been updated</li>
<li>Find out which object that was</li>
<li>See the new position is has and if that position is already taken up</li>
<li>Track whether that object went up or down in position</li>
<li>Change the other positions accordingly</li>
</ul>


<p>Myself and <a href="https://twitter.com/aviflombaum">Avi</a> were actually constructing the code to write this whole thing out.  We started by writing a rails test:</p>

<p><img src="/images/unittest.png" alt="My params" /></p>

<p>Here we are testing to see if we change the position of a studio, we need the other studios&#8217; positions to change accordingly.</p>

<p>Now here&rsquo;s the real issue, all of the CRUD of an object in this app is being done by <a href="http://www.activeadmin.info/">Active Admin</a>.  Actually I guess it wasn&rsquo;t so hard to know where to look to solve this problemâ€¦callbacks.</p>

<p>Cool we here the best this to do is the have a before_save callback.  We need to check if the  current object has been changed.  But wait, duh, there&rsquo;s this thing called <a href="https://github.com/swanandp/acts_as_list">acts_as_list</a> that does the reordering for you.  Luckily, this gem has a method (:insert_at(#)) that not only inserts the object where you want it but also reorders the list, doing the heavy lifting for us.</p>

<p>Great.  The idea that this process requires a before_save callback is right, and now we just need to connect the dots.  We must ask if a object has been changed, then insert it accordingly:</p>

<p><img src="/images/beforefilter.png" alt="My params" /></p>

<p><img src="/images/actslist.png" alt="My params" /></p>

<p>and bam, we can change any object to have a different position and the rest of the positions are reordered, and it works with Active Admin.  Check.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/10/fancybox-gallery/">FancyBox Gallery Trix</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-10T10:23:00-05:00" pubdate data-updated="true">Dec 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Cool, so one of the features my latest client is asking me to do is adding is an image gallery of their studios.  After searching around for a little bit, I stumbled upon the <a href="https://github.com/hecticjeff/fancybox-rails">Fancybox Rails</a> gem.  Cool, let&rsquo;s check it out.</p>

<p>This gem is great, it adds all the assets required for <a href="http://fancybox.net/">Fancybox</a> to your assets, and all you have to do is add:</p>

<p>//= require fancybox</p>

<p>to your application.js file and:</p>

<p>*= require fancy box</p>

<p>to your application.css file.</p>

<p>Awesome.  Now that all of that is squared away, let&rsquo;s get to work.  In our controller we are working with this array:</p>

<p><img src="/images/galleryall.png" alt="My params" /></p>

<p>This is an array of all the pictures we are working with.  If we want to loop through all of these, we use the following code:</p>

<p><img src="/images/fancyloop.png" alt="My params" /></p>

<p>If we throw on a little jQuery, we get a workable Fancybox:</p>

<p><img src="/images/fancycode.png" alt="My params" /></p>

<p>What happens here is were are looking through all the paintings in the gallery and setting them to the same :rel.  This allows Fancybox to know all images with :rel &ldquo;studio_images&rdquo; is to be grouped together in a gallery.</p>

<p>The problem here is that we now have eight links, with all eight links opening up to the same gallery.  That&rsquo;s not good, we want one link to open to all of the images in the gallery.  Cool, let&rsquo;s solve this problem.</p>

<p>How about we make two instance variables in the controller, one for the first image, and one for the rest, this way if we ever delete the first image, another will replace it.  The benefit here is that there will be no image duplication because between the two arrays, we will have all the images, but no duplicates.</p>

<p><img src="/images/fancycontroller.png" alt="My params" /></p>

<p>So now we have these two variable, and we need to make a link in the view to open the gallery.  Let&rsquo;s do that:</p>

<p><img src="/images/click_thing.png" alt="My params" /></p>

<p>If you have noticed, both lines of code have different id&rsquo;s, can you guess why?  If we have both lines of code, we will have eight different links.  We only want one link, let&rsquo;s hide the second array.</p>

<p><img src="/images/fancyhide.png" alt="My params" /></p>

<p>And you are left with one link which points to all the images in your gallery, good work.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/10/highlight-current-page-rails/">Highlight Current Page Rails</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-10T09:23:00-05:00" pubdate data-updated="true">Dec 10<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&rsquo;ll admit, I am not an authority figure when it comes to front end.  I&rsquo;m not talking about things like <a href="http://getbootstrap.com/">Bootstrap</a>, I&rsquo;m talking about getting super down and dirty within a stylesheet.</p>

<p>I had a fun little problem to solve yesterday when working on the site for my current client.  The client wanted the page the user was currently on to be highlighted in the navbar.</p>

<p>I immediately thought to add some sort of conditional, but went strait to <a href="http://stackoverflow.com/">Stack Overflow</a> to see what programmers before me have done.</p>

<p>Turns out, there are two ways you can do something like this.  In both scenarios, we are going to create a helper method, but the helper method can check different things.</p>

<p>For those who are not making a navbar dynamically, I would suggest using the following:</p>

<p><img src="/images/controllermethod.png" alt="My params" /></p>

<p><img src="/images/controllercode.png" alt="My params" /></p>

<p>This way, you can have the helper method return some thing (in this case, the name of the new class) depending on what controller the request is using.</p>

<p>If you are going to dynamically create the navbar, I suggest you do something like this:</p>

<p><img src="/images/pathmethod.png" alt="My params" /></p>

<p><img src="/images/pathcode.png" alt="My params" /></p>

<p>This way, the helper is checking the request url, and simply passing in the path.  I actually found this second way of doing this buggy because the root path becomes highlighted for all the other paths.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/12/09/serializing-model-attributes/">Serialize Attributes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-09T09:23:00-05:00" pubdate data-updated="true">Dec 9<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So after I successfully jail-rigged my blog, I can now make new posts.  I have a bunch that I want to talk about, but one I wanted touch on today was serializing attributes for a model.</p>

<p>Here is the scenario.  One of the index pages for my currently client lists all the items they have available for rent (it&rsquo;s a music company).  They have microphones, computers, instruments, anything you could rent.  It&rsquo;s probably about 10 different categories of products that a customer can rent.</p>

<p>I built the back end with <a href="http://www.activeadmin.info/">ActiveAdmin</a> so the client can easily change the content of the site.  The previous developer had hard coded all of the content, and the client was not comfortable going into the actual code to make changes.</p>

<p>So we have a rental page that lists all the items for rent.  Because there are 10 different categories of items, do I want to make 10 different models and do the proper associations, or because the items only have names do I want to come up with something else?</p>

<p>I found out that I could serialize an attribute in rails.  Its super simple:</p>

<p><img src="/images/serialize.png" alt="My params" /></p>

<p>What we are doing his is simple, rather than creating a whole nothing model and creating the association, this model (staff), can have many titles, but those titles cannot have many attributes.</p>

<p>This was a really good way for allow the client to add many single attribute attributes to a model.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/01/29/count/">What&#8217;s This Difference</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/14/heroku-schedule/">15 Second Heroku Wait?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/13/stubhub/">Open Source</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/01/07/angular/">Angular on Rails</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/12/27/push-to-heroku/">Heroku, AWS, DNS Simple</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/stevenabrooks">@stevenabrooks</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'stevenabrooks',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Steven Brooks -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
